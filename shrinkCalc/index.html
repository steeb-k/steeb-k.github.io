<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shrinkage Calculator</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1>Shrinkage Calculator</h1>
        <a class="help-link" id="helpLink">How to use this tool</a>
        
        <div class="input-grid">
            <div></div>
            <div>First</div>
            <div>Second</div>
            <div>Third</div>
            
            <div class="axis-label">X-Axis</div>
            <div><input type="number" id="x-top" placeholder="Enter value"></div>
            <div><input type="number" id="x-middle" placeholder="Enter value"></div>
            <div><input type="number" id="x-bottom" placeholder="Enter value"></div>
            
            <div class="axis-label">Y-Axis</div>
            <div><input type="number" id="y-top" placeholder="Enter value"></div>
            <div><input type="number" id="y-middle" placeholder="Enter value"></div>
            <div><input type="number" id="y-bottom" placeholder="Enter value"></div>
            
            <div class="axis-label">Z-Axis</div>
            <div><input type="number" id="z-top" placeholder="Enter value"></div>
            <div><input type="number" id="z-middle" placeholder="Enter value"></div>
            <div><input type="number" id="z-bottom" placeholder="Enter value"></div>
        </div>
        
        <div class="current-shrinkage">
            <div>
                <span>Current XY Shrinkage:</span>
                <input type="number" id="current-xy" value="100" placeholder="Percentage">
                <span>%</span>
            </div>
            <div>
                <span>Current Z Shrinkage:</span>
                <input type="number" id="current-z" value="100" placeholder="Percentage">
                <span>%</span>
            </div>
        </div>
        
        <button class="calculate-btn" id="calculateBtn">Calculate</button>
        
        <div class="results">
            <div>
                <h3>XY Shrinkage</h3>
                <div class="result-value" id="xyResult">-</div>
            </div>
            <div>
                <h3>Z Shrinkage</h3>
                <div class="result-value" id="zResult">-</div>
            </div>
        </div>

        <a class="formula-link" id="formulaLink">How are these results calculated?</a>
    </div>

    <!-- Formula Overlay -->
    <div class="formula-overlay" id="formulaOverlay">
        <div class="formula-content">
            <button class="close-formula" id="closeFormula">&times;</button>
            <h2>Calculation Formulas</h2>
            
            <div class="formula">
                <h3>XY Shrinkage</h3>
                <math xmlns="http://www.w3.org/1998/Math/MathML">
                    <mtext>XY = </mtext>
                    <mfrac>
                        <mrow>
                            <mo>(</mo>
                            <mfrac>
                                <mrow>
                                    <msub><mi>X</mi><mi>top</mi></msub>
                                    <mo>+</mo>
                                    <msub><mi>X</mi><mi>middle</mi></msub>
                                    <mo>+</mo>
                                    <msub><mi>X</mi><mi>bottom</mi></msub>
                                </mrow>
                                <mn>3</mn>
                            </mfrac>
                            <mo>+</mo>
                            <mfrac>
                                <mrow>
                                    <msub><mi>Y</mi><mi>top</mi></msub>
                                    <mo>+</mo>
                                    <msub><mi>Y</mi><mi>middle</mi></msub>
                                    <mo>+</mo>
                                    <msub><mi>Y</mi><mi>bottom</mi></msub>
                                </mrow>
                                <mn>3</mn>
                            </mfrac>
                            <mo>)</mo>
                        </mrow>
                        <mn>40</mn>
                    </mfrac>
                    <mo>×</mo>
                    <mtext>CurrentXY%</mtext>
                </math>
                <p>Where:<br>
                - X and Y values are averaged separately<br>
                - The two averages are then averaged together<br>
                - Divided by 20 (shown as ÷40 in the formula)<br>
                - Multiplied by your current XY shrinkage percentage</p>
            </div>
            
            <div class="formula">
                <h3>Z Shrinkage</h3>
                <math xmlns="http://www.w3.org/1998/Math/MathML">
                    <mtext>Z = </mtext>
                    <mfrac>
                        <mrow>
                            <msub><mi>Z</mi><mi>top</mi></msub>
                            <mo>+</mo>
                            <msub><mi>Z</mi><mi>middle</mi></msub>
                            <mo>+</mo>
                            <msub><mi>Z</mi><mi>bottom</mi></msub>
                        </mrow>
                        <mn>60</mn>
                    </mfrac>
                    <mo>×</mo>
                    <mtext>CurrentZ%</mtext>
                </math>
                <p>Where:<br>
                - Z values are averaged<br>
                - Divided by 20 (shown as ÷60 in the formula)<br>
                - Multiplied by your current Z shrinkage percentage</p>
            </div>
        </div>
    </div>

    <!-- Help Overlay -->
    <div class="help-overlay" id="helpOverlay">
        <div class="help-content">
            <button class="close-help" id="closeHelp">&times;</button>
            <h2>How to Use This Tool</h2>
            
            <div class="help-grid">
                <div class="help-svg">
                    <svg width="100" height="100" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                        <!-- Outer square with 10px border -->
                        <rect x="5" y="5" width="90" height="90" fill="none" stroke="var(--svg-stroke)" stroke-width="5"/>
                        
                        <!-- Large X in center (80% of interior size) -->
                        <line x1="15" y1="15" x2="85" y2="85" stroke="var(--svg-stroke)" stroke-width="10"/>
                        <line x1="85" y1="15" x2="15" y2="85" stroke="var(--svg-stroke)" stroke-width="10"/>
                        
                        <!-- Three horizontal lines -->
                        <line x1="0" y1="10" x2="100" y2="10" stroke="var(--svg-red)" stroke-width="3"/>
                        <line x1="0" y1="50" x2="100" y2="50" stroke="var(--svg-red)" stroke-width="3"/>
                        <line x1="0" y1="90" x2="100" y2="90" stroke="var(--svg-red)" stroke-width="3"/>
                      </svg>
                </div>
                <div class="help-text">
                    <p>This tool is designed to help fine-tune your XY & Z shrinkage (what it's called in Orca Slicer - it may be something else in other slicers!) by printing <a href="https://www.thingiverse.com/thing:1278865" target="_blank">this calibration cube</a>, taking some basic measurements, and filling out this calculator.</a></p>
                    <ol>
                        <li>Print your calibration cube with your usual print settings.</li>
                        <li>Measure in 3 locations along each axis, noting them in the calculator.</li>
                        <li>If you already have a shrinkage setting, then enter that value in the calcuator, as well - otherwise, leave it at 100.</li>
                        <li>Click "Calculate" and then use those values in your slicer.</li>
                    </ol>
                    <p>Keep in mind:</p>
                    <ul>
                        <li>You must enter a value into every box. Blank boxes will count as zero and give wildly inaccurate results.</li>
                        <li>This tool is based on the 20mmx20mmx20mm calibration cube linked. With other STLs, you may receive wildly different results.</li>
                        <li>If your measurements are off by more than 5-10% initially, you likely need to calibrate something else on your printer first -- this is a fine-tuning step.</li>
                        <li>You may still need to adjust your XY hole compensation - this tool can only help account for external dimensions.</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
